# # GitLab CI Job Templates
#
# These templates can be used to execute jobs on different runners.
# 
# Use GitLab's "include" keyword to include this file and the "extends" to
# extend a template below.
#
# For more details, see https://docs.gitlab.com/ee/ci/yaml/README.html#using-extends-and-include-together

.template_deploy_branch:
    stage: deploy

    # TODO: Write scipt "package_vadere.py" which packages "vadere_console.jar", "vadere.jar"
    # and folder "VadereModelTests" into one ZIP file.
    # Pass GitLab CI variables (like below) to create filenames for JAR files and final ZIP file.
    script:
        - mvn clean
        - mvn -Dmaven.test.skip=true package
        - python3 -m zipfile -c VadereModelTests/ VadereGui/target/vadere.jar vadere-console.jar vadere.${CI_COMMIT_REF_NAME}.${CI_COMMIT_SHA}.${CI_ENVIRONMENT_NAME}.zip
        - scp vadere.${CI_COMMIT_REF_NAME}.${CI_COMMIT_SHA}.${CI_ENVIRONMENT_NAME}.zip di49mur@webdev-mwn.lrz.de:~/webserver/htdocs/builds/branches/vadere.${CI_COMMIT_REF_NAME}.${CI_COMMIT_SHA}.${CI_ENVIRONMENT_NAME}.zip
    when: manual
